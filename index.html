<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>EventPad MVP</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="header">
    <h1>EventPad</h1>
    <div class="header-actions">
      <button class="header-btn" id="undoBtn" disabled>‚Ü∂ Undo</button>
      <button class="header-btn">Clear</button>
    </div>
  </div>

  <div class="event-log-toggle">
    üìã Events (<span id="eventCount">0</span>)
  </div>
  
  <div class="event-log" id="eventLog">
    <div class="event-log-header">
      <span>Event Stream</span>
      <div class="event-log-actions">
        <button class="header-btn" onclick="window.EventPad.copyAllEvents()" style="padding: 4px 8px; font-size: 11px;">Copy All</button>
        <button class="event-log-close" onclick="window.EventPad.toggleEventLog()">√ó</button>
      </div>
    </div>
    <div class="event-log-list" id="eventLogList"></div>
  </div>

  <div class="feed" id="feed">
    <div class="empty-state" id="emptyState">
      <div class="empty-state-icon">üüß</div>
      <div class="empty-state-text">Tap + to create your first element</div>
    </div>
  </div>

  <div class="fab" id="fab">+</div>

  <!-- Create Element Sheet -->
  <div class="sheet-overlay" id="createSheet">
    <div class="sheet">
      <div class="sheet-handle"></div>
      <div class="sheet-title">Create Element</div>
      <div class="sheet-options">
        <div class="sheet-option" onclick="EventPad.selectType('event')">
          <div class="sheet-option-icon" style="background: var(--event); color: #000;">üüß</div>
          <div class="sheet-option-text">
            <div class="sheet-option-title">Event</div>
            <div class="sheet-option-desc">Something that happened</div>
          </div>
        </div>
        <div class="sheet-option" onclick="EventPad.selectType('command')">
          <div class="sheet-option-icon" style="background: var(--command); color: #fff;">üü¶</div>
          <div class="sheet-option-text">
            <div class="sheet-option-title">Command</div>
            <div class="sheet-option-desc">An action to perform</div>
          </div>
        </div>
        <div class="sheet-option" onclick="EventPad.selectType('readModel')">
          <div class="sheet-option-icon" style="background: var(--readmodel); color: #000;">üü©</div>
          <div class="sheet-option-text">
            <div class="sheet-option-title">Read Model</div>
            <div class="sheet-option-desc">Data for display</div>
          </div>
        </div>
        <div class="sheet-option" onclick="EventPad.selectType('screen')">
          <div class="sheet-option-icon" style="background: var(--screen); color: #000;">‚èπÔ∏è</div>
          <div class="sheet-option-text">
            <div class="sheet-option-title">Screen</div>
            <div class="sheet-option-desc">User interface</div>
          </div>
        </div>
        <div class="sheet-option" onclick="EventPad.selectType('processor')">
          <div class="sheet-option-icon" style="background: var(--processor); color: #fff;">‚öôÔ∏è</div>
          <div class="sheet-option-text">
            <div class="sheet-option-title">Processor</div>
            <div class="sheet-option-desc">Automation logic</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Name Element Sheet -->
  <div class="sheet-overlay" id="nameSheet">
    <div class="sheet">
      <div class="sheet-handle"></div>
      <div class="sheet-title" id="nameSheetTitle">Name your Event</div>
      <input type="text" class="sheet-input" id="elementNameInput" placeholder="e.g. OrderCreated">
      <button class="sheet-btn" onclick="EventPad.submitCreateElement()">Create</button>
    </div>
  </div>

  <!-- Action Sheet -->
  <div class="sheet-overlay" id="actionSheet">
    <div class="sheet">
      <div class="sheet-handle"></div>
      <div class="sheet-title" id="actionSheetTitle">Connect Element</div>
      <div class="sheet-options" id="actionOptions"></div>
    </div>
  </div>

  <!-- Element Picker Sheet -->
  <div class="sheet-overlay" id="pickerSheet">
    <div class="sheet">
      <div class="sheet-handle"></div>
      <div class="sheet-title" id="pickerSheetTitle">Pick Command</div>
      <div class="sheet-options" id="pickerOptions"></div>
      <div style="text-align: center; padding: 12px; color: var(--text-muted); font-size: 13px;" id="pickerEmpty">No elements available</div>
    </div>
  </div>

  <!-- Element Menu Sheet -->
  <div class="sheet-overlay" id="elementMenuSheet">
    <div class="sheet">
      <div class="sheet-handle"></div>
      <div class="sheet-title" id="elementMenuTitle">Element</div>
      <div class="sheet-options" id="elementMenuOptions"></div>
    </div>
  </div>

  <!-- Property Sheet -->
  <div class="sheet-overlay" id="propertySheet">
    <div class="sheet">
      <div class="sheet-handle"></div>
      <div class="sheet-title" id="propertySheetTitle">Add Property</div>
      <input type="text" class="sheet-input" id="propertyNameInput" placeholder="e.g. orderId, amount, status">
      <select class="sheet-input" id="propertyTypeSelect">
        <option value="string">String</option>
        <option value="number">Number</option>
        <option value="boolean">Boolean</option>
        <option value="date">Date</option>
        <option value="guid">GUID</option>
        <option value="array">Array</option>
        <option value="object">Object</option>
      </select>
      <button class="sheet-btn" onclick="EventPad.saveProperty()">Save Property</button>
      <button class="sheet-btn" id="deletePropertyBtn" onclick="EventPad.deleteProperty()" style="background: #c0392b; margin-top: 8px; display: none;">Delete Property</button>
    </div>
  </div>

  <!-- Multi-Select Picker Sheet -->
  <div class="sheet-overlay" id="multiPickerSheet">
    <div class="sheet">
      <div class="sheet-handle"></div>
      <div class="sheet-title" id="multiPickerSheetTitle">Select Events</div>
      <div class="sheet-options" id="multiPickerOptions"></div>
      <div style="text-align: center; padding: 12px; color: var(--text-muted); font-size: 13px;" id="multiPickerEmpty">No elements available</div>
      <button class="sheet-btn" id="multiPickerConfirm" onclick="window.EventPad.confirmMultiPick()" style="margin-top: 16px;" disabled>Select (0)</button>
    </div>
  </div>

  <!-- Name Slice Sheet -->
  <div class="sheet-overlay" id="sliceNameSheet">
    <div class="sheet">
      <div class="sheet-handle"></div>
      <div class="sheet-title">üéâ Pattern detected!</div>
      <p style="color: var(--text-muted); margin-bottom: 16px; font-size: 14px;" id="slicePatternDesc"></p>
      <input type="text" class="sheet-input" id="sliceNameInput" placeholder="e.g. Create Order">
      <button class="sheet-btn" onclick="EventPad.dispatchNameSlice()">Save Slice</button>
      <div style="text-align: center; padding: 12px; color: var(--text-muted); cursor: pointer;" onclick="EventPad.dismissSlicePrompt()">Skip for now</div>
    </div>
  </div>

  <!-- Add Scenario Sheet -->
  <div class="sheet-overlay" id="addScenarioSheet">
    <div class="sheet">
      <div class="sheet-handle"></div>
      <div class="sheet-title" id="addScenarioTitle">Add Scenario</div>
      <input type="text" class="sheet-input" id="scenarioNameInput" placeholder="e.g. Create order successfully">
      <p style="color: var(--text-muted); font-size: 12px; margin: 8px 0 16px;" id="scenarioTypeHint">Given/When/Then</p>
      <button class="sheet-btn" onclick="window.EventPad.submitAddScenario()">Add Scenario</button>
    </div>
  </div>

  <!-- Edit Scenario Sheet -->
  <div class="sheet-overlay" id="editScenarioSheet">
    <div class="sheet" style="max-height: 85vh; overflow-y: auto;">
      <div class="sheet-handle"></div>
      <div class="sheet-title" id="editScenarioTitle">Edit Scenario</div>
      
      <div class="scenario-section">
        <div class="section-label">GIVEN</div>
        <div id="givenEventsList" class="checkbox-list"></div>
      </div>
      
      <div class="scenario-section" id="whenSection">
        <div class="section-label">WHEN</div>
        <select class="sheet-input" id="whenCommandSelect" style="padding: 12px;">
          <option value="">Select command...</option>
        </select>
      </div>
      
      <div class="scenario-section">
        <div class="section-label">THEN</div>
        <div id="thenOptions"></div>
      </div>
      
      <div style="display: flex; gap: 12px; margin-top: 20px;">
        <button class="sheet-btn danger" onclick="window.EventPad.deleteScenario()" style="flex: 1;">Delete</button>
        <button class="sheet-btn" onclick="window.EventPad.saveScenario()" style="flex: 2;">Save</button>
      </div>
    </div>
  </div>

  <div class="toast" id="toast"></div>

  <script type="module" src="src/main.js"></script>
</body>
</html>
